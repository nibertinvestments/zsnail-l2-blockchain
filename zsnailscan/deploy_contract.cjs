const axios = require('axios');

const rpcUrl = 'http://34.122.156.185:8545';
const deployerAddress = '0x9a36a3e13586f6b114aA78fD84b6fe6055f83b48';

// Bytecode from forge inspect (with constructor args encoded)
const bytecode = '0x60806040526040518060400160405280600c81526020017f5a536e61696c20546f6b656e00000000000000000000000000000000000000008152505f908162000049919062000488565b506040518060400160405280600681526020017f5a534e41494c00000000000000000000000000000000000000000000000000008152506001908162000090919062000488565b50601260025f6101000a81548160ff021916908360ff1602179055506103e8600655600160075f6101000a81548160ff02191690831515021790555069065a4da25d3016c00000600855348015620000e6575f80fd5b50604051620022663803806200226683398181016040528101906200010c9190620005d1565b80600b5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506a084595161401484a0000006003819055506a084595161401484a00000060045f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055508073ffffffffffffffffffffffffffffffffffffffff165f73ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef6a084595161401484a00000060405162000215919062000612565b60405180910390a3506200062d565b5f81519050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f6002820490506001821680620002a057607f821691505b602082108103620002b657620002b56200025b565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026200031a7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82620002dd565b620003268683620002dd565b95508019841693508086168417925050509392505050565b5f819050919050565b5f819050919050565b5f620003706200036a62000364846200033e565b62000347565b6200033e565b9050919050565b5f819050919050565b6200038b8362000350565b620003a36200039a8262000377565b848454620002e9565b825550505050565b5f90565b620003b9620003ab565b620003c681848462000380565b505050565b5b81811015620003ed57620003e15f82620003af565b600181019050620003cc565b5050565b601f8211156200043c576200040681620002bc565b6200041184620002ce565b8101602085101562000421578190505b620004396200043085620002ce565b830182620003cb565b50505b505050565b5f82821c905092915050565b5f6200045e5f198460080262000441565b1980831691505092915050565b5f6200047883836200044d565b9150826002028217905092915050565b620004938262000224565b67ffffffffffffffff811115620004af57620004ae6200022e565b5b620004bb825462000288565b620004c8828285620003f1565b5f60209050601f831160018114620004fe575f8415620004e9578287015190505b620004f585826200046b565b86555062000564565b601f1984166200050e86620002bc565b5f5b82811015620005375784890151825560018201915060208501945060208101905062000510565b8683101562000557578489015162000553601f8916826200044d565b8355505b6001600288020188555050505b505050505050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6200059b8262000570565b9050919050565b620005ad816200058f565b8114620005b8575f80fd5b50565b5f81519050620005cb81620005a2565b92915050565b5f60208284031215620005e957620005e86200056c565b5b5f620005f884828501620005bb565b91505092915050565b6200060c816200033e565b82525050565b5f602082019050620006275f83018462000601565b92915050565b611c2b806200063b5f395ff3fe608060405234801561000f575f80fd5b5060043610610135575f3560e01c806384cc8c31116100b6578063c089d3531161007a578063c089d3531461033f578063da79c1dc1461035d578063dd62ed3e1461038d578063ec2130be146103bd578063f14c1bb6146103db578063fa52c7d81461040b57610135565b806384cc8c31146102995780638da5cb5b146102a357806395d89b41146102c1578063a9059cbb146102df578063aa7355781461030f57610135565b806323b872dd116100fd57806323b872dd146101e1578063313ce5671461021157806332cb6b0c1461022f57806340c10f191461024d57806370a082311461026957610135565b8063017ddd351461013957806306fdde0314610157578063095ea7b31461017557806318160ddd146101a55780631ba569ef146101c3575b5f80fd5b61014161043b565b60405161014e9190611376565b60405180910390f35b61015f610441565b60405161016c9190611419565b60405180910390f35b61018f600480360381019061018a91906114c1565b6104cc565b60405161019c9190611519565b60405180910390f35b6101ad6105b9565b6040516101ba9190611376565b60405180910390f35b6101cb6105bf565b6040516101d89190611376565b60405180910390f35b6101fb60048036038101906101f69190611532565b6105c5565b6040516102089190611519565b60405180910390f35b6102196108a5565b604051610226919061159d565b60405180910390f35b6102376108b7565b6040516102449190611376565b60405180910390f35b610267600480360381019061026291906114c1565b6108c8565b005b610283600480360381019061027e91906115b6565b610a88565b6040516102909190611376565b60405180910390f35b6102a1610a9d565b005b6102ab610da5565b6040516102b891906115f0565b60405180910390f35b6102c9610dca565b6040516102d69190611419565b60405180910390f35b6102f960048036038101906102f491906114c1565b610e56565b6040516103069190611519565b60405180910390f35b610329600480360381019061032491906115b6565b610fec565b6040516103369190611376565b60405180910390f35b610347611001565b6040516103549190611519565b60405180910390f35b610377600480360381019061037291906115b6565b611013565b6040516103849190611519565b60405180910390f35b6103a760048036038101906103a29190611609565b61105b565b6040516103b49190611376565b60405180910390f35b6103c561107b565b6040516103d29190611376565b60405180910390f35b6103f560048036038101906103f09190611647565b61108a565b6040516104029190611376565b60405180910390f35b610425600480360381019061042091906115b6565b611341565b6040516104329190611519565b60405180910390f35b60085481565b5f805461044d9061169f565b80601f01602080910402602001604051908101604052809291908181526020018280546104799061169f565b80156104c45780601f1061049b576101008083540402835291602001916104c4565b820191905f5260205f20905b8154815290600101906020018083116104a757829003601f168201915b505050505081565b5f8160055f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925846040516105a79190611376565b60405180910390a36001905092915050565b60035481565b60065481565b5f8160055f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20541015610681576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161067890611719565b60405180910390fd5b8160045f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20541015610701576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106f890611781565b60405180910390fd5b8160055f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825461078891906117cc565b925050819055508160045f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8282546107db91906117cc565b925050819055508160045f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825461082e91906117ff565b925050819055508273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040516108929190611376565b60405180910390a3600190509392505050565b60025f9054906101000a900460ff1681565b6c01431e0fae6d7217caa000000081565b600b5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610957576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161094e9061187c565b60405180910390fd5b6c01431e0fae6d7217caa00000008160035461097391906117ff565b11156109b4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109ab906118e4565b60405180910390fd5b8060035f8282546109c591906117ff565b925050819055508060045f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254610a1891906117ff565b925050819055508173ffffffffffffffffffffffffffffffffffffffff165f73ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef83604051610a7c9190611376565b60405180910390a35050565b6004602052805f5260405f205f915090505481565b60085460045f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20541015610b1f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b169061194c565b60405180910390fd5b600a5f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1615610ba9576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ba0906119b4565b60405180910390fd5b60085460095f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055506001600a5f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff02191690831515021790555060085460045f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254610c9091906117cc565b9250508190555060085460045f3073ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254610ce591906117ff565b925050819055503373ffffffffffffffffffffffffffffffffffffffff167fbdf8f4c0feff7f456c5c1fd1c42716baa7ee66801a0b860872009ac945403fa0600854604051610d349190611376565b60405180910390a23073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef600854604051610d9b9190611376565b60405180910390a3565b600b5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60018054610dd79061169f565b80601f0160208091040260200160405190810160405280929190818152602001828054610e039061169f565b8015610e4e5780601f10610e2557610100808354040283529160200191610e4e565b820191905f5260205f20905b815481529060010190602001808311610e3157829003601f168201915b505050505081565b5f8160045f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20541015610ed7576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ece90611781565b60405180910390fd5b8160045f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254610f2391906117cc565b925050819055508160045f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254610f7691906117ff565b925050819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef84604051610fda9190611376565b60405180910390a36001905092915050565b6009602052805f5260405f205f915090505481565b60075f9054906101000a900460ff1681565b5f8060045f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054149050919050565b6005602052815f5260405f20602052805f5260405f205f91509150505481565b6a084595161401484a00000081565b5f60075f9054906101000a900460ff166110d9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016110d090611a1c565b60405180910390fd5b5f60045f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205411611158576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161114f90611aaa565b60405180910390fd5b5f600654633b9aca008461116c9190611ac8565b6111769190611b36565b90508060045f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205410156111f8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016111ef90611bb0565b60405180910390fd5b8060045f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825461124491906117cc565b925050819055508060035f82825461125c91906117cc565b92505081905550670de0b6b3a76400006006548261127a9190611ac8565b6112849190611b36565b91503373ffffffffffffffffffffffffffffffffffffffff167f5970f98f46c716c9bf2807e25361ca9ae2dd19a164af4cdf425b13f12db4b68982856040516112ce929190611bce565b60405180910390a25f73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040516113339190611376565b60405180910390a350919050565b600a602052805f5260405f205f915054906101000a900460ff1681565b5f819050919050565b6113708161135e565b82525050565b5f6020820190506113895f830184611367565b92915050565b5f81519050919050565b5f82825260208201905092915050565b5f5b838110156113c65780820151818401526020810190506113ab565b5f8484015250505050565b5f601f19601f8301169050919050565b5f6113eb8261138f565b6113f58185611399565b93506114058185602086016113a9565b61140e816113d1565b840191505092915050565b5f6020820190508181035f83015261143181846113e1565b905092915050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6114668261143d565b9050919050565b6114768161145c565b8114611480575f80fd5b50565b5f813590506114918161146d565b92915050565b6114a08161135e565b81146114aa575f80fd5b50565b5f813590506114bb81611497565b92915050565b5f80604083850312156114d7576114d6611439565b5b5f6114e485828601611483565b92505060206114f5858286016114ad565b9150509250929050565b5f8115159050919050565b611513816114ff565b82525050565b5f60208201905061152c5f83018461150a565b92915050565b5f805f6060848603121561154957611548611439565b5b5f61155686828701611483565b935050602061156786828701611483565b9250506040611578868287016114ad565b9150509250925092565b5f60ff82169050919050565b61159781611582565b82525050565b5f6020820190506115b05f83018461158e565b92915050565b5f602082840312156115cb576115ca611439565b5b5f6115d884828501611483565b91505092915050565b6115ea8161145c565b82525050565b5f6020820190506116035f8301846115e1565b92915050565b5f806040838503121561161f5761161e611439565b5b5f61162c85828601611483565b925050602061163d85828601611483565b9150509250929050565b5f6020828403121561165c5761165b611439565b5b5f611669848285016114ad565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f60028204905060018216806116b657607f821691505b6020821081036116c9576116c8611672565b5b50919050565b7f496e73756666696369656e7420616c6c6f77616e6365000000000000000000005f82015250565b5f611703601683611399565b915061170e826116cf565b602082019050919050565b5f6020820190508181035f830152611730816116f7565b9050919050565b7f496e73756666696369656e742062616c616e63650000000000000000000000005f82015250565b5f61176b601483611399565b915061177682611737565b602082019050919050565b5f6020820190508181035f8301526117988161175f565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6117d68261135e565b91506117e18361135e565b92508282039050818111156117f9576117f861179f565b5b92915050565b5f6118098261135e565b91506118148361135e565b925082820190508082111561182c5761182b61179f565b5b92915050565b7f4e6f74206f776e657200000000000000000000000000000000000000000000005f82015250565b5f611866600983611399565b915061187182611832565b602082019050919050565b5f6020820190508181035f8301526118938161185a565b9050919050565b7f45786365656473206d617820737570706c7900000000000000000000000000005f82015250565b5f6118ce601283611399565b91506118d98261189a565b602082019050919050565b5f6020820190508181035f8301526118fb816118c2565b9050919050565b7f496e73756666696369656e74207374616b6500000000000000000000000000005f82015250565b5f611936601283611399565b915061194182611902565b602082019050919050565b5f6020820190508181035f8301526119638161192a565b9050919050565b7f416c726561647920612076616c696461746f72000000000000000000000000005f82015250565b5f61199e601383611399565b91506119a98261196a565b602082019050919050565b5f6020820190508181035f8301526119cb81611992565b9050919050565b7f47617320746f6b656e207061796d656e74732064697361626c656400000000005f82015250565b5f611a06601b83611399565b9150611a11826119d2565b602082019050919050565b5f6020820190508181035f830152611a33816119fa565b9050919050565b7f4d7573742068617665205a534e41494c20746f6b656e7320746f2070617920675f8201527f6173000000000000000000000000000000000000000000000000000000000000602082015250565b5f611a94602283611399565b9150611a9f82611a3a565b604082019050919050565b5f6020820190508181035f830152611ac181611a88565b9050919050565b5f611ad28261135e565b9150611add8361135e565b9250828202611aeb8161135e565b91508282048414831517611b0257611b0161179f565b5b5092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f611b408261135e565b9150611b4b8361135e565b925082611b5b57611b5a611b09565b5b828204905092915050565b7f496e73756666696369656e74205a536e61696c20666f722067617300000000005f82015250565b5f611b9a601b83611399565b9150611ba582611b66565b602082019050919050565b5f6020820190508181035f830152611bc781611b8e565b9050919050565b5f604082019050611be15f830185611367565b611bee6020830184611367565b939250505056fea264697066735822122079174341993cb16e528780794bdaa9fb076bafdb1c7109c9fbac213b9be99ed364736f6c634300081400330000000000000000000000009a36a3e13586f6b114aa78fd84b6fe6055f83b48';

async function deployContract() {
  try {
    // Get nonce
    const nonceResponse = await axios.post(rpcUrl, {
      jsonrpc: '2.0',
      method: 'eth_getTransactionCount',
      params: [deployerAddress, 'latest'],
      id: 1
    });
    const nonce = nonceResponse.data.result;
    console.log('Nonce:', nonce);

    // Prepare transaction
    const tx = {
      jsonrpc: '2.0',
      method: 'eth_sendTransaction',
      params: [{
        from: deployerAddress,
        to: null,
        data: bytecode,
        gas: '0x2DC6C0', // 3 million gas
        gasPrice: '0x3B9ACA00', // 1 gwei
        nonce: nonce
      }],
      id: 1
    };

    console.log('Sending transaction...');
    const response = await axios.post(rpcUrl, tx);
        
    if (response.data.error) {
      console.error('Error:', response.data.error);
      return;
    }

    const txHash = response.data.result;
    console.log('Transaction hash:', txHash);

    // Wait for receipt
    console.log('Waiting for receipt...');
    let receipt = null;
    let attempts = 0;
    while (!receipt && attempts < 30) {
      await new Promise(resolve => setTimeout(resolve, 2000));
            
      const receiptResponse = await axios.post(rpcUrl, {
        jsonrpc: '2.0',
        method: 'eth_getTransactionReceipt',
        params: [txHash],
        id: 1
      });
            
      receipt = receiptResponse.data.result;
      attempts++;
    }

    if (receipt) {
      console.log('Contract deployed at:', receipt.contractAddress);
      console.log('Gas used:', receipt.gasUsed);
      console.log('Status:', receipt.status === '0x1' ? 'Success' : 'Failed');
    } else {
      console.log('Receipt not found after 60 seconds');
    }

  } catch (error) {
    console.error('Deployment failed:', error.response?.data || error.message);
  }
}

deployContract();
